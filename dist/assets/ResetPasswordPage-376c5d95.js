import{h as S,i as P,r as a,s as t,j as e,H as k,B as h,L as R,l as w,I as x}from"./index-41fdcd60.js";import{P as B}from"./PageHeader-e3a9be96.js";import{C as H,a as L,b as U,e as _,c as E}from"./card-d9ac1da7.js";const F=()=>{const f=S(),{toast:o}=P(),[g,l]=a.useState(!0),[b,c]=a.useState(!1),[u,j]=a.useState(""),[p,y]=a.useState(""),[i,d]=a.useState(!1),m=!t;a.useEffect(()=>{if(!t){l(!1);return}let s;(async()=>{const{data:n}=await t.auth.getSession();c(!!n?.session),l(!1)})();const{data:r}=t.auth.onAuthStateChange((n,C)=>{c(!!C),l(!1)});return s=r?.subscription,()=>{s?.unsubscribe()}},[]);const v=async s=>{if(s.preventDefault(),!t)return;const r=u.trim();if(r.length<6){o({title:"Password too short",description:"Use at least 6 characters.",variant:"destructive"});return}if(r!==p.trim()){o({title:"Passwords do not match",description:"Please re-type your new password.",variant:"destructive"});return}d(!0);const{error:n}=await t.auth.updateUser({password:r});if(n){o({title:"Could not reset password",description:n.message,variant:"destructive"}),d(!1);return}o({title:"Password updated",description:"You can now continue using your account.",className:"bg-green-500 text-white"}),d(!1),f("/dashboard")},N=a.useMemo(()=>typeof window>"u"?"https://www.rivercitybikerentals.com/reset-password":`${window.location.origin}/reset-password`,[]);return e.jsxs("div",{children:[e.jsxs(k,{children:[e.jsx("title",{children:"Reset Password | Rivercity Bike Rentals"}),e.jsx("meta",{name:"robots",content:"noindex"}),e.jsx("link",{rel:"canonical",href:N})]}),e.jsx(B,{title:"Reset your password",subtitle:"Choose a new password for your account.",breadcrumbs:[{name:"Home",link:"/"},{name:"Reset password"}]}),e.jsx("section",{className:"py-16 lg:py-24 bg-gray-50",children:e.jsx("div",{className:"container mx-auto px-4 flex justify-center",children:e.jsxs(H,{className:"w-full max-w-md shadow-xl",children:[e.jsxs(L,{className:"text-center",children:[e.jsx(U,{className:"text-2xl",children:"Set a new password"}),e.jsx(_,{children:m?"Password reset is currently unavailable.":"Enter and confirm your new password."})]}),e.jsx(E,{className:"space-y-6",children:g?e.jsx("p",{className:"text-sm text-gray-600 text-center",children:"Loading…"}):m?e.jsx("p",{className:"text-sm text-gray-600 text-center",children:"Supabase is not configured."}):b?e.jsxs("form",{onSubmit:v,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{htmlFor:"new_password",children:"New password"}),e.jsx(x,{id:"new_password",type:"password",value:u,onChange:s=>j(s.target.value),placeholder:"••••••••",required:!0,disabled:i})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{htmlFor:"confirm_password",children:"Confirm new password"}),e.jsx(x,{id:"confirm_password",type:"password",value:p,onChange:s=>y(s.target.value),placeholder:"••••••••",required:!0,disabled:i})]}),e.jsx(h,{type:"submit",className:"w-full bg-blue-600 hover:bg-blue-700",disabled:i,children:i?"Updating…":"Update password"})]}):e.jsxs("div",{className:"space-y-3 text-sm text-gray-700",children:[e.jsx("p",{children:"Please open the password reset link from your email. If the link expired, request a new one from the login page."}),e.jsx(h,{asChild:!0,className:"w-full bg-blue-600 hover:bg-blue-700",children:e.jsx(R,{to:"/login",children:"Back to login"})})]})})]})})})]})};export{F as default};
